= Aux BMS Tests

== HeartBeat Test
----
Elapsed 5000ms{
	Expect 5 Heartbeat CAN messages (0x720)
}
----

== Aux Test
----
Elapsed 1000ms{
	Expect 10 Aux CAN messages (0x721)
}
----

== Test Cases
[options="header"]
|===
| Test | CAN_ADDRESS | DATA_INDEX | TIME_FRAME
| Precharge State |  0x721  |  |  100ms 
| Aux Voltage |  0x721 |  3-7 |  100ms 
| Charge Contactor State |  0x721  | 0-2 |  100ms 
| Contactor State |  0x721  | 0 |  100ms 
| All Contactor On |  0x721 |  0-2 |  100ms 
| Discharge Off |  0x721  | 0-2 |  100ms 
| Safety |  0x721 |  0-2 |  100ms 
| Allow Charge |  0x721  | 9 |  100ms 
| Strobe BMS Light |  0x721 | 8 |  100ms |
|===

== Precharge State Test
----
Send (PRECHARGE_CAN_MESSAGE(CAN_ADDRESS))
	Elapsed TIME_FRAME{
		Expect (PRECHARGE_CAN_MESSAGE(CAN_ADDRESS))
}
----

== Aux Voltage Test
----
//Start Test
Elapsed TIME_FRAME{
    Expect (VOLTAGE_CAN_MESSAGE(CAN_ADDRESS)[DATA_INDEX])
}
----

== Charge Contactor Test
----
//Start Test
Within TIME_FRAME{
	Expect (CONTACTOR_CAN_MESSAGE(CAN_ADDRESS)[DATA_INDEX])
}
----

== Contactor State Test
----
//Start Test
Within TIME_FRAME{
	Expect (CONTACTOR_CAN_MESSAGE(CAN_ADDRESS)[DATA_INDEX])
}
----

== All Contactor On Test
----
//Start Test

Within 5s{
    Expect (CONTACTOR_CAN_MESSAGE(CAN_ADDRESS)[DATA_INDEX] == 0b001) 
        COMMON LED ON
}
Within 5s{
    Expect (CONTACTOR_CAN_MESSAGE(CAN_ADDRESS)[DATA_INDEX] == 0b011) 
        COMMON LED ON
        CHARGE LED ON
}
Within 5s{
    Expect (CONTACTOR_CAN_MESSAGE(CAN_ADDRESS)[DATA_INDEX] == 0b111) 
        COMMON LED ON
        CHARGE LED ON
        DISCHARGE LED ON
}
Within 5s{
    Expect (CONTACTOR_CAN_MESSAGE(CAN_ADDRESS)[DATA_INDEX] == 0b111) 
   	    COMMON LED ON
   	    CHARGE LED ON
   	    DISCHARGE LED ON
}
----

== Discharge Off Test
----
//Start Discharge Test

Within 5s{
    Expect (CONTACTOR_CAN_MESSAGE(CAN_ADDRESS)[DATA_INDEX] == 0b101) 
        COMMON LED ON
        CHARGE LED ON
}
----

== Safety Test
----
//Start Safety Test

Within 5s{
    Expect (CONTACTOR_CAN_MESSAGE(CAN_ADDRESS)[DATA_INDEX] == 0b000) 
        COMMON LED ON
        DISCHARGE LED ON
}
----

== Strobe BMS Light Test
----
Send(BMS_CAN_MESSAGE(CAN_ADDRESS) == 0x200)
    Within 200ms{
        Expect (LIGHTS_CAN_MESSAGE(0x711) == 0x20)
}
----

== Allow Charge Test
----
Send(BMS_CAN_MESSAGE(CAN_ADDRESS)[DATA_INDEX] == 1)
    Within TIME_FRAME{
        COMMON LED ON
        CHARGE LED ON
}
----